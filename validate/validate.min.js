!function(e){"define"in window?define(function(t,n,i){i.exports=e()}):window.Validate=e()}(function(){"use strict";function e(e){return"trim"in String.prototype?e.trim():e.replace(/^\s+|\s+$/g,"")}function t(){this.eventList={}}function n(e){this.extend(e),this.init()}function i(e){e=e.replace(/\s/g,"");var t=e.charAt(0);if("#"==t)return document.getElementById(e.replace(/#/g,""));if("."==t){for(var n=[],i=document.getElementsByTagName("*"),r=new RegExp("\\b"+e.replace(/\./g,"")+"\\b","g"),a=0;a<i.length;a++)r.test(i[a].className)&&n.push(i[a]),r.lastIndex=0;return n}return document.getElementsByTagName(e)}var r=Array.prototype.slice,a=t.prototype;a.on=function(e,t){return t instanceof Function?(this.eventList[e]=this.eventList[e]||[],this.eventList[e].push(t),!0):void 0},a.off=function(e,t,n){if(t instanceof Function){e+="";var i;if(i=this.eventList[e])for(var r=0;r<i.length;r++)if(t==i[r]){i.splice(r,1);break}}},a.emit=function(e){e+="";var t;if(t=this.eventList[e])for(var n=0;n<t.length;n++)t[n].apply(this,r.call(arguments,1,arguments.length))},n.prototype=new t;var s=n.prototype;return s.extend=function(e,t){1==arguments.length&&(t=e,e=this);for(var n in t)t[n]instanceof RegExp||"object"!=typeof t[n]||t[n].nodeType?e[n]=t[n]:t[n]instanceof Array?e[n]=t[n].slice(0):this.extend(e[n]={},t[n])},s.addEvent=function(e,t,n){e.nodeType&&"string"==typeof t&&n instanceof Function&&("addEventListener"in e?e.addEventListener(t,function(){n.apply(e,arguments)}):e.attachEvent("on"+t,function(){n.apply(e,arguments)}))},s.init=function(){var e=this;if(this.form&&"FORM"===this.form.tagName&&(this.action=this.form.action,this.method=this.form.method,this.form.onsubmit=function(){return!e.checkForm||e.action===e.form.action&&e.method===e.form.method?e.checkAll()?void 0:!1:(alert("表单提交参数发生了改变，禁止提交"),!1)}),this.rules){var t;for(var n in this.rules)t=i("#"+n),t.nodeType&&!function(n){var i=e.rules[n]||{};e.addEvent(t,"focus",function(){e.emit("focus",this)}),e.addEvent(t,"blur",function(){var t=e.check(this);e.emit("blur",this,t)}),e.addEvent(t,"change",function(){i.pass=!1,e.emit("change",this)})}(n)}},s.checkAll=function(){var e=!0;for(var t in this.rules)this.check(t)||(e=!1);return e},s.check=function(t){var n=this,r=t.nodeType?t:i("#"+t);t=t.nodeType?t.id:t;var a,s=this.rules[t],o=this.message[t],c=e(r.value),u=s.recordValue!==c;if(s.recordValue=c,!s)return!0;if(!u&&s.pass)return this.emit("success",r),!0;if(s.required&&0===c.length)return a=o?o.required||"":"",this.emit("error",r,a||"不能为空"),!1;if(s.minlength&&c.length<s.minlength)return a=o?o.minlength||"":"",this.emit("error",r,a||"最少"+s.minlength+"个字符"),!1;if(s.maxlength&&c.length>s.maxlength)return a=o?o.maxlength||"":"",this.emit("error",r,a||"最多"+s.maxlength+"个字符"),!1;if(s.equal){var h=i(s.equal);if(!h.nodeType||c!==h.value)return a=o?o.equal||"":"",this.emit("error",r,a||"两次输入结果不相同"),!1}if(s.type||s.reg){var f;switch(s.type){case"username":f=/^[\da-zA-Z_]+$/g;break;case"password":f=/^[\da-zA-Z_.~@!$^#%*&+-]+$/g;break;case"email":f=/^[\da-zA-Z_.\-]+@[\da-zA-Z]+\.[a-zA-Z]{2,4}$/g;break;case"url":f=/^https?\:\/\/[\da-zA-Z.]+(?:\:\d+)?(?:\/[\da-zA-Z_.-]+)+\/?$/g;break;case"phone":f=/^\d{11}|\d{3,4}-\d{7,8}$/g}if(f=s.reg?s.reg:f,!(!(c.length>0)||f&&f instanceof RegExp&&f.test(c)))return a=o?o.formate||"":"",this.emit("error",r,a||"格式错误"),!1}return s.wait&&"function"==typeof s.wait?u||s.pass?(s.wait.call(this,r,function(e,t){c===r.value&&(s.pass=!!e,e?n.emit("success",r):(o.wait=t||o.wait||"检查失败",n.emit("error",r,o.wait)))}),!1):(n.emit("error",r,o.wait),!1):(c.length>0&&this.emit("success",r),s.pass=!0,!0)},n});