!function(t){"define"in window&&define.cmd?define(function(e,n,i){i.exports=t()}):window.Validate=t()}(function(){"use strict";function t(t){return"trim"in String.prototype?t.trim():t.replace(/^\s+|\s+$/g,"")}function e(){this.eventList={}}function n(t){this.extend(t),this.init()}function i(t){t=t.replace(/\s/g,"");var e=t.charAt(0);if("#"==e)return document.getElementById(t.replace(/#/g,""));if("."==e){for(var n=[],i=document.getElementsByTagName("*"),r=new RegExp("\\b"+t.replace(/\./g,"")+"\\b","g"),a=0;a<i.length;a++)r.test(i[a].className)&&n.push(i[a]),r.lastIndex=0;return n}return document.getElementsByTagName(t)}var r={username:/^[\da-zA-Z_]+$/g,password:/^[\da-zA-Z_.~@!$^#%*&+-]+$/g,email:/^[\da-zA-Z_.\-]+@[\da-zA-Z]+\.[a-zA-Z]{2,4}$/g,url:/^https?\:\/\/[\da-zA-Z.]+(?:\:\d+)?(?:\/[\da-zA-Z_.-]+)+\/?$/g,phone:/^\d{11}|\d{3,4}-\d{7,8}$/g},a=Array.prototype.slice,s=e.prototype;s.on=function(t,e){return e instanceof Function?(this.eventList[t]=this.eventList[t]||[],this.eventList[t].push(e),!0):void 0},s.off=function(t,e){if(e instanceof Function){t+="";var n;if(n=this.eventList[t])for(var i=0;i<n.length;i++)if(e==n[i]){n.splice(i,1);break}}},s.emit=function(t){t+="";var e;if(e=this.eventList[t])for(var n=0;n<e.length;n++)e[n].apply(this,a.call(arguments,1,arguments.length))},n.prototype=new e;var o=n.prototype;return o.extend=function(t,e){1==arguments.length&&(e=t,t=this);for(var n in e)e[n]instanceof RegExp||"object"!=typeof e[n]||e[n].nodeType?t[n]=e[n]:e[n]instanceof Array?t[n]=e[n].slice(0):this.extend(t[n]={},e[n])},o.addEvent=function(t,e,n){t.nodeType&&"string"==typeof e&&n instanceof Function&&("addEventListener"in t?t.addEventListener(e,function(){n.apply(t,arguments)}):t.attachEvent("on"+e,function(){n.apply(t,arguments)}))},o.init=function(){var t=this;if(this.form&&"FORM"===this.form.tagName&&(this.action=this.form.action,this.method=this.form.method,this.form.onsubmit=function(){return!t.checkForm||t.action===t.form.action&&t.method===t.form.method?t.checkAll()?void 0:!1:(alert("表单提交参数发生了改变，禁止提交"),!1)}),this.rules){var e;for(var n in this.rules)e=i("#"+n),e.nodeType&&!function(n){var i=t.rules[n]||{};t.addEvent(e,"focus",function(){t.emit("focus",this)}),t.addEvent(e,"blur",function(){var e=t.check(this);t.emit("blur",this,e)}),t.addEvent(e,"change",function(){i.pass=!1,t.emit("change",this)})}(n)}},o.checkAll=function(){var t=!0;for(var e in this.rules)this.check(e)||(t=!1);return t},o.check=function(e){var n=this,a=e.nodeType?e:i("#"+e);e=e.nodeType?e.id:e;var s,o=this.rules[e],u=this.message[e],c=t(a.value),h=o.recordValue!==c;if(o.recordValue=c,!o)return!0;if(o.required&&0===c.length)return s=u?u.required||"":"",this.emit("error",a,s||"不能为空"),!1;if(o.minlength&&c.length<o.minlength)return s=u?u.minlength||"":"",this.emit("error",a,s||"最少"+o.minlength+"个字符"),!1;if(o.maxlength&&c.length>o.maxlength)return s=u?u.maxlength||"":"",this.emit("error",a,s||"最多"+o.maxlength+"个字符"),!1;if(o.equal){var f="string"==typeof o.equal?i(o.equal):o.equal;if(!f.nodeType||c!==f.value)return s=u?u.equal||"":"",this.emit("error",a,s||"两次输入结果不相同"),!1}if(o.notequal){var l="string"==typeof o.notequal?i(o.notequal):o.notequal;if(!l.nodeType||c===l.value)return s=u?u.notequal||"":"",this.emit("error",a,s||"两次输入结果不能相同"),!1}if(o.type||o.reg){var m=o.reg||r[o.type];if(c.length&&m instanceof RegExp){if(!m.test(c))return s=u?u.formate||"":"",this.emit("error",a,s||"格式错误"),!1;m.lastIndex=0}}return o.wait&&"function"==typeof o.wait?h?(o.wait.call(this,a,function(t,e){c===a.value&&(o.pass=!!t,t?n.emit("success",a):(u.wait=e||u.wait||"检查失败",n.emit("error",a,u.wait)))}),!1):(o.pass?this.emit("success",a):this.emit("error",a,u.wait),o.pass):(c.length>0&&this.emit("success",a),o.pass=!0,!0)},n});