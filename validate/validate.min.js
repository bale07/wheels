!function(e){"define"in window&&define.cmd?define(function(t,n,i){i.exports=e()}):window.Validate=e()}(function(){"use strict";function e(){this.eventList={}}function t(e){this.extend(e),this.init()}function n(e){e=e.replace(/\s/g,"");var t=e.charAt(0);if("#"==t)return document.getElementById(e.replace(/#/g,""));if("."==t){for(var n=[],i=document.getElementsByTagName("*"),r=new RegExp("\\b"+e.replace(/\./g,"")+"\\b","g"),a=0;a<i.length;a++)r.test(i[a].className)&&n.push(i[a]),r.lastIndex=0;return n}return document.getElementsByTagName(e)}var i={username:/^[\da-zA-Z_]+$/g,password:/^[\da-zA-Z_.~@!$^#%*&+-]+$/g,email:/^[\da-zA-Z_.\-]+@[\da-zA-Z]+\.[a-zA-Z]{2,4}$/g,url:/^https?\:\/\/[\da-zA-Z.]+(?:\:\d+)?(?:\/[\da-zA-Z_.-]+)+\/?$/g,phone:/^\d{11}|\d{3,4}-\d{7,8}$/g},r=Array.prototype.slice,a=e.prototype;a.on=function(e,t){return t instanceof Function?(this.eventList[e]=this.eventList[e]||[],this.eventList[e].push(t),!0):void 0},a.off=function(e,t){if(t instanceof Function){e+="";var n;if(n=this.eventList[e])for(var i=0;i<n.length;i++)if(t==n[i]){n.splice(i,1);break}}},a.emit=function(e){e+="";var t;if(t=this.eventList[e])for(var n=0;n<t.length;n++)t[n].apply(this,r.call(arguments,1,arguments.length))},t.prototype=new e;var s=t.prototype;return s.extend=function(e,t){1==arguments.length&&(t=e,e=this);for(var n in t)t[n]instanceof RegExp||"object"!=typeof t[n]||t[n].nodeType?e[n]=t[n]:t[n]instanceof Array?e[n]=t[n].slice(0):this.extend(e[n]={},t[n])},s.addEvent=function(e,t,n){e.nodeType&&"string"==typeof t&&n instanceof Function&&("addEventListener"in e?e.addEventListener(t,function(){n.apply(e,arguments)}):e.attachEvent("on"+t,function(){n.apply(e,arguments)}))},s.init=function(){var e=this;if(this.form&&"FORM"===this.form.tagName&&(this.action=this.form.action,this.method=this.form.method,this.form.onsubmit=function(){return!e.checkForm||e.action===e.form.action&&e.method===e.form.method?e.checkAll()?void 0:!1:(alert("表单提交参数发生了改变，禁止提交"),!1)}),this.rules){var t;for(var i in this.rules)t=n("#"+i),t.nodeType&&!function(n){var i=e.rules[n]||{};e.addEvent(t,"focus",function(){e.emit("focus",this)}),e.addEvent(t,"blur",function(){var t=e.check(this);e.emit("blur",this,t)}),e.addEvent(t,"change",function(){i.pass=!1,e.emit("change",this)})}(i)}},s.checkAll=function(){var e=!0;for(var t in this.rules)this.check(t)||(e=!1);return e},s.check=function(e){var t=this,r=e.nodeType?e:n("#"+e);e=e.nodeType?e.id:e;var a,s=this.rules[e],o=this.message[e],u=r.value,c=s.recordValue!==u;if(s.recordValue=u,!s)return!0;if(s.required&&0===u.length)return a=o?o.required||"":"",this.emit("error",r,a||"不能为空"),!1;if(s.minlength&&u.length<s.minlength)return a=o?o.minlength||"":"",this.emit("error",r,a||"最少"+s.minlength+"个字符"),!1;if(s.maxlength&&u.length>s.maxlength)return a=o?o.maxlength||"":"",this.emit("error",r,a||"最多"+s.maxlength+"个字符"),!1;if(s.equal){var h="string"==typeof s.equal?n(s.equal):s.equal;if(!h.nodeType||u!==h.value)return a=o?o.equal||"":"",this.emit("error",r,a||"两次输入结果不相同"),!1}if(s.notequal){var f="string"==typeof s.notequal?n(s.notequal):s.notequal;if(!f.nodeType||u===f.value)return a=o?o.notequal||"":"",this.emit("error",r,a||"两次输入结果不能相同"),!1}if(s.type||s.reg){var l=s.reg||i[s.type];if(u.length&&l instanceof RegExp){if(!l.test(u))return a=o?o.formate||"":"",this.emit("error",r,a||"格式错误"),!1;l.lastIndex=0}}return s.wait&&"function"==typeof s.wait?c?(s.wait.call(this,r,function(e,n){u===r.value&&(s.pass=!!e,e?t.emit("success",r):(o.wait=n||o.wait||"检查失败",t.emit("error",r,o.wait)))}),!1):(s.pass?this.emit("success",r):this.emit("error",r,o.wait),s.pass):(u.length>0&&this.emit("success",r),s.pass=!0,!0)},t});