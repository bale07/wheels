!function(e){"define"in window?define(function(t,n,i){i.exports=e()}):window.Validate=e()}(function(){"use strict";function e(e){return"trim"in String.prototype?e.trim():e.replace(/^\s+|\s+$/g,"")}function t(){this.eventList={}}function n(e){this.extend(e),this.init()}function i(e){e=e.replace(/\s/g,"");var t=e.charAt(0);if("#"==t)return document.getElementById(e.replace(/#/g,""));if("."==t){for(var n=[],i=document.getElementsByTagName("*"),r=new RegExp("\\b"+e.replace(/\./g,"")+"\\b","g"),s=0;s<i.length;s++)r.test(i[s].className)&&n.push(i[s]),r.lastIndex=0;return n}return document.getElementsByTagName(e)}var r=Array.prototype.slice,s=t.prototype;s.on=function(e,t){return t instanceof Function?(this.eventList[e]=this.eventList[e]||[],this.eventList[e].push(t),!0):void 0},s.off=function(e,t,n){if(t instanceof Function){e+="";var i;if(i=this.eventList[e])for(var r=0;r<i.length;r++)if(t==i[r]){i.splice(r,1);break}}},s.emit=function(e){e+="";var t;if(t=this.eventList[e])for(var n=0;n<t.length;n++)t[n].apply(this,r.call(arguments,1,arguments.length))},n.prototype=new t;var a=n.prototype;return a.extend=function(e,t){1==arguments.length&&(t=e,e=this);for(var n in t)t[n]instanceof RegExp||"object"!=typeof t[n]||t[n].nodeType?e[n]=t[n]:t[n]instanceof Array?e[n]=t[n].slice(0):this.extend(e[n]={},t[n])},a.addEvent=function(e,t,n){e.nodeType&&"string"==typeof t&&n instanceof Function&&("addEventListener"in e?e.addEventListener(t,function(){n.apply(e,arguments)}):e.attachEvent("on"+t,function(){n.apply(e,arguments)}))},a.init=function(){var e=this;if(this.form&&"FORM"===this.form.tagName&&(this.action=this.form.action,this.method=this.form.method,this.form.onsubmit=function(){return!e.checkForm||e.action===e.form.action&&e.method===e.form.method?e.checkAll()?void 0:!1:(alert("表单提交参数发生了改变，禁止提交"),!1)}),this.rules){var t;for(var n in this.rules)t=i("#"+n),t.nodeType&&!function(n){var i=e.rules[n]||{};e.addEvent(t,"focus",function(){i.focuing=!0,e.emit("focus",this)}),e.addEvent(t,"blur",function(){i.focuing=!1;var t=e.check(this);e.emit("blur",this,t)}),e.addEvent(t,"change",function(){i.pass=!1,e.emit("change",this)})}(n)}},a.checkAll=function(){for(var e in this.rules)if(!this.check(e))return!1;return!0},a.check=function(t){var n=this,r=t.nodeType?t:i("#"+t);t=t.nodeType?t.id:t;var s,a=this.rules[t],o=this.message[t],c=e(r.value),u=a.recordValue!==c;if(a.recordValue=c,!a)return!0;if(a.pass)return this.emit("success",r),!0;if(a.required&&0===c.length)return s=o?o.required||"":"",this.emit("error",r,s||"不能为空"),!1;if(a.minlength&&c.length<a.minlength)return s=o?o.minlength||"":"",this.emit("error",r,s||"最少"+a.minlength+"个字符"),!1;if(a.maxlength&&c.length>a.maxlength)return s=o?o.maxlength||"":"",this.emit("error",r,s||"最多"+a.maxlength+"个字符"),!1;if(a.equal){var h=i(a.equal);if(!h.nodeType||c!==h.value)return s=o?o.equal||"":"",this.emit("error",r,s||"两次输入结果不相同"),!1}if(a.type||a.reg){var f;switch(a.type){case"username":f=/^[\da-zA-Z_]+$/g;break;case"password":f=/^[\da-zA-Z_.~@!$^#%*&+-]+$/g;break;case"email":f=/^[\da-zA-Z_.\-]+@[\da-zA-Z]+\.[a-zA-Z]{2,4}$/g;break;case"url":f=/^https?\:\/\/[\da-zA-Z.]+(?:\:\d+)?(?:\/[\da-zA-Z_.-]+)+\/?$/g;break;case"phone":f=/^\d{11}|\d{3,4}-\d{7,8}$/g}if(f=a.reg?a.reg:f,!(!(c.length>0)||f&&f instanceof RegExp&&f.test(c)))return s=o?o.formate||"":"",this.emit("error",r,s||"格式错误"),!1}return a.wait&&"function"==typeof a.wait?u||a.pass?(a.wait.call(this,r,function(e,t){c===r.value&&(a.pass||(a.pass=!!e,a.focuing||(e?n.emit("success",r):(o.wait=t||o.wait||"检查失败",n.emit("error",r,o.wait)))))}),!1):(n.emit("error",r,o.wait),!1):(c.length>0&&this.emit("success",r),a.pass=!0,!0)},n});