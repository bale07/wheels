!function(e){"define"in window?define(function(t,n,i){i.exports=e()}):window.Validate=e()}(function(){"use strict";function e(e){return"trim"in String.prototype?e.trim():e.replace(/^\s+|\s+$/g,"")}function t(){this.eventList={}}function n(e){this.extend(e),this.init()}function i(e){e=e.replace(/\s/g,"");var t=e.charAt(0);if("#"==t)return document.getElementById(e.replace(/#/g,""));if("."==t){for(var n=[],i=document.getElementsByTagName("*"),r=new RegExp("\\b"+e.replace(/\./g,"")+"\\b","g"),s=0;s<i.length;s++)r.test(i[s].className)&&n.push(i[s]),r.lastIndex=0;return n}return document.getElementsByTagName(e)}var r=Array.prototype.slice,s=t.prototype;s.addListener=s.on=function(e,t){return t instanceof Function?(e+="",this.eventList[e]=this.eventList[e]||[],this.eventList[e].push({method:t}),!0):void 0},s.once=function(e,t){if(this.on(e,t)){var n=this.eventList[e];n[n.length-1].once=!0}},s.removeListener=s.unon=function(e,t,n){if(t instanceof Function){e+="";var i;if(i=this.eventList[e])for(var r=0;r<i.length;r++)if(t==i[r].method){i.splice(r,1);break}}},s.removeAllListener=function(e){e?(e+="",this.eventList[e]&&delete this.eventList[e]):this.eventList={}},s.emit=function(e){e+="";var t;if(t=this.eventList[e])for(var n=0;n<t.length;n++)t[n].method.apply(this,r.call(arguments,1,arguments.length)),t[n].once&&(t.splice(n,1),n--)},n.prototype=new t;var o=n.prototype;return o.extend=function(e,t){1==arguments.length&&(t=e,e=this);for(var n in t)"object"!=typeof t[n]||t[n].nodeType?e[n]=t[n]:t[n]instanceof Array?e[n]=t[n].slice(0):this.extend(e[n]={},t[n])},o.addEvent=function(e,t,n){e.nodeType&&"string"==typeof t&&n instanceof Function&&("addEventListener"in e?e.addEventListener(t,function(){n.apply(e,arguments)}):e.attachEvent("on"+t,function(){n.apply(e,arguments)}))},o.init=function(){var e=this;if(this.form&&"FORM"===this.form.tagName&&(this.action=this.form.action,this.method=this.form.method,this.form.onsubmit=function(){return!e.checkForm||e.action===e.form.action&&e.method===e.form.method?e.checkAll()?void 0:!1:(alert("表单提交参数发生了改变，禁止提交"),!1)}),this.rules){var t;for(var n in this.rules)t=i("#"+n),t.nodeType&&!function(n){var i=e.rules[n]||{};e.addEvent(t,"focus",function(){i.focuing=!0,e.emit("focus",this)}),e.addEvent(t,"blur",function(){i.focuing=!1;var t=e.check(this);e.emit("blur",this,t)}),e.addEvent(t,"change",function(){i.pass=!1})}(n)}},o.checkAll=function(){for(var e in this.rules)if(!this.check(e))return!1;return!0},o.check=function(t){var n=this,r=t.nodeType?t:i("#"+t);t=t.nodeType?t.id:t;var s,o=this.rules[t],a=this.message[t],c=e(r.value);if(!o)return!0;if(o.pass)return this.emit("success",r),!0;if(o.required&&0===c.length)return s=a?a.required||"":"",this.emit("error",r,s||"不能为空"),!1;if(o.minlength&&c.length<o.minlength)return s=a?a.minlength||"":"",this.emit("error",r,s||"最少"+o.minlength+"个字符"),!1;if(o.maxlength&&c.length>o.maxlength)return s=a?a.maxlength||"":"",this.emit("error",r,s||"最多"+o.maxlength+"个字符"),!1;if(o.equal){var u=i(o.equal);if(!u.nodeType||c!==u.value)return s=a?a.equal||"":"",this.emit("error",r,s||"两次输入结果不相同"),!1}if(o.type||o.reg){var h;switch(o.type){case"username":h=/^[\da-zA-Z_]+$/g;break;case"password":h=/^[\da-zA-Z_.~@!$^#%*&+-]+$/g;break;case"email":h=/^[\da-zA-Z_.\-]+@[\da-zA-Z]+\.[a-zA-Z]{2,4}$/g;break;case"url":h=/^https?\:\/\/[\da-zA-Z.:]+(\/[\da-zA-Z_.-]+)+\/?$/g}if(h=o.reg?o.reg:h,!(!(c.length>0)||h&&h instanceof RegExp&&h.test(c)))return s=a?a.formate||"":"",this.emit("error",r,s||"格式错误"),!1}return o.wait&&"function"==typeof o.wait?(o.wait.call(this,function(e,t){c===r.value&&(o.pass||(o.pass=!!e,o.focuing||(e?n.emit("success",r):n.emit("error",r,t||"检查失败"))))}),!1):(c.length>0&&this.emit("success",r),o.pass=!0,!0)},n});