!function(t){"define"in window?define(function(e,n,i){i.exports=t()}):window.Validate=t()}(function(){"use strict";function t(t){return"trim"in String.prototype?t.trim():t.replace(/^\s+|\s+$/g,"")}function e(){this.eventList={}}function n(t){this.extend(t),this.init()}function i(t){t=t.replace(/\s/g,"");var e=t.charAt(0);if("#"==e)return document.getElementById(t.replace(/#/g,""));if("."==e){for(var n=[],i=document.getElementsByTagName("*"),r=new RegExp("\\b"+t.replace(/\./g,"")+"\\b","g"),s=0;s<i.length;s++)r.test(i[s].className)&&n.push(i[s]),r.lastIndex=0;return n}return document.getElementsByTagName(t)}var r=e.prototype;r.on=function(t,e){e instanceof Function&&(t+="",this.eventList[t]=this.eventList[t]||[],this.eventList[t].push(e))},r.unon=function(t,e){if(e instanceof Function&&(t+="",t in this.eventList))for(var n=this.eventList[t],i=0;i<n.length;i++)if(e==n[i]){n.splice(i,1);break}},r.emit=function(t){if(t+="",t in this.eventList)for(var e=this.eventList[t],n=0;n<e.length;n++)e[n].apply(this,Array.prototype.slice.call(arguments,1,arguments.length))},n.prototype=new e;var s=n.prototype;return s.extend=function(t,e){1==arguments.length&&(e=t,t=this);for(var n in e)"object"!=typeof e[n]||e[n].nodeType?t[n]=e[n]:e[n]instanceof Array?t[n]=e[n].slice(0):this.extend(t[n]={},e[n])},s.addEvent=function(t,e,n){t.nodeType&&"string"==typeof e&&n instanceof Function&&("addEventListener"in t?t.addEventListener(e,function(){n.apply(t,arguments)}):t.attachEvent("on"+e,function(){n.apply(t,arguments)}))},s.init=function(){var t=this;if(this.form&&"FORM"===this.form.tagName&&(this.action=this.form.action,this.method=this.form.method,this.form.onsubmit=function(){return!t.checkForm||t.action===t.form.action&&t.method===t.form.method?t.checkAll()?void 0:!1:(alert("表单提交参数发生了改变，禁止提交"),!1)}),this.rules){var e;for(var n in this.rules)e=i("#"+n),e.nodeType&&!function(n){var i=t.rules[n]||{};t.addEvent(e,"focus",function(){i.focuing=!0,t.emit("focus",this)}),t.addEvent(e,"blur",function(){i.focuing=!1;var e=t.check(this);t.emit("blur",this,e)}),t.addEvent(e,"change",function(){i.pass=!1})}(n)}},s.checkAll=function(){for(var t in this.rules)if(!this.check(t))return!1;return!0},s.check=function(e){var n=this,r=e.nodeType?e:i("#"+e);e=e.nodeType?e.id:e;var s,a=this.rules[e],o=this.message[e],c=t(r.value);if(!a)return!0;if(a.pass)return this.emit("success",r),!0;if(a.required&&0===c.length)return s=o?o.required||"":"",this.emit("error",r,s||"不能为空"),!1;if(a.minlength&&c.length<a.minlength)return s=o?o.minlength||"":"",this.emit("error",r,s||"最少"+a.minlength+"个字符"),!1;if(a.maxlength&&c.length>a.maxlength)return s=o?o.maxlength||"":"",this.emit("error",r,s||"最多"+a.maxlength+"个字符"),!1;if(a.equal){var u=i(a.equal);if(!u.nodeType||c!==u.value)return s=o?o.equal||"":"",this.emit("error",r,s||"两次输入结果不相同"),!1}if(a.type||a.reg){var h;switch(a.type){case"username":h=/^[\da-zA-Z_]+$/g;break;case"password":h=/^[\da-zA-Z_.~@!$^#%*&+-]+$/g;break;case"email":h=/^[\da-zA-Z_.\-]+@[\da-zA-Z]+\.[a-zA-Z]{2,4}$/g;break;case"url":h=/^https?\:\/\/[\da-zA-Z.:]+(\/[\da-zA-Z_.-]+)+\/?$/g}if(h=a.reg?a.reg:h,!(!(c.length>0)||h&&h instanceof RegExp&&h.test(c)))return s=o?o.formate||"":"",this.emit("error",r,s||"格式错误"),!1}return a.wait&&"function"==typeof a.wait?(a.wait.call(this,function(t,e){c===r.value&&(a.pass||(a.pass=!!t,a.focuing||(t?n.emit("success",r):n.emit("error",r,e||"检查失败"))))}),!1):(c.length>0&&this.emit("success",r),a.pass=!0,!0)},n});